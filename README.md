# 糖尿病眼底病变分割和分类
# 1.数据集准备
## 1.1 数据集下载
首先准备糖尿病病变分割的数据集，在这里我们选取南开大学的DDR数据集进行模型训练，该数据集包括分类，分割和目标检测三个部分
下载地址如下:[OIA-DDR数据集](https://news.nankai.edu.cn/ywsd/system/2019/12/07/030036739.shtml)
## 1.2 数据集预处理
在这里预处理包含两部分  
首先对于分割数据集,我们需要将四种标签的图片融到一张,用于之后的多标签分割,在这里执行`utils/change.py`中的
再将分类数据集按照四种类别分别分开,用于数据集的读取
# 2. 模型训练
## 2.1 模型选取
在这里,针对眼底病变小样本的特点，我们选取了unet作为网络架构,用来进行病变分割
特征提取网络选用restnet50,训练所需的权值可在百度网盘中下载。    
链接: https://pan.baidu.com/s/1A22fC5cPRb74gqrpq7O9-A    
提取码: 6n2c   
## 2.2 模型训练
模型训练执行train.py即可,注意在train.py内设置对应超参,具体见train.py文件夹
## 2.3 模型预测
执行那个get_miou.py文件,即可获取分割结果，并生成对应指标，存储分割结果